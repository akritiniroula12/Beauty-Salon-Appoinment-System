generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model User {
  id           Int           @id @default(autoincrement())
  name         String?       @db.VarChar(100)
  email        String        @unique @db.VarChar(255)
  password     String        @db.VarChar(255)
  isActive     Boolean       @default(true)
  role         Role          @default(CUSTOMER)
  staffProfile Staff?
  appointments Appointment[]
  reviews      Review[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Staff {
  id           Int           @id @default(autoincrement())
  user         User?         @relation(fields: [userId], references: [id])
  userId       Int?          @unique
  name         String
  email        String        @unique
  role         String        // e.g., Stylist, Manager
  specialization String?     @db.VarChar(100)
  bio          String?       @db.Text
  skills       String?       @db.Text // Comma separated skills
  availability Json?         // Store working hours as JSON
  isActive     Boolean       @default(true)
  appointments Appointment[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Service {
  id           Int           @id @default(autoincrement())
  name         String        @unique @db.VarChar(100)
  description  String?
  duration     Int           // in minutes
  price        Float
  image        String?       @db.Text
  appointments Appointment[]
  reviews      Review[]
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
}

model Appointment {
  id              Int               @id @default(autoincrement())
  user            User              @relation(fields: [userId], references: [id])
  userId          Int
  service         Service           @relation(fields: [serviceId], references: [id])
  serviceId       Int
  staff           Staff?            @relation(fields: [staffId], references: [id])
  staffId         Int?
  appointmentDate DateTime
  status          AppointmentStatus @default(PENDING)
  paymentStatus   PaymentStatus     @default(PENDING)
  notes           String?
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
}

model Review {
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  service   Service  @relation(fields: [serviceId], references: [id])
  serviceId Int
  rating    Int      // 1 to 5
  comment   String?
  createdAt DateTime @default(now())
}

enum Role {
  CUSTOMER
  ADMIN
  STAFF
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  CANCELLED
  COMPLETED
}

enum PaymentStatus {
  PENDING
  PAID
  FAILED
}